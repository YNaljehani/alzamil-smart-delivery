<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASDP - Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§ØªØ³Ø§Ø¨</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="css/shared.css" rel="stylesheet">
    <link href="css/whatsapp.css" rel="stylesheet">
</head>
<body>

    <!-- ====== Navigation ====== -->
    <nav class="asdp-navbar">
        <a href="index.html" class="nav-brand">
            <div class="logo-icon">ğŸš›</div>
            <span>ASDP</span>
        </a>
        <ul class="nav-links">
            <li><a href="index.html"><i class="bi bi-house-door"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a href="sra-form.html"><i class="bi bi-clipboard-check"></i> ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹</a></li>
            <li><a href="dashboard.html"><i class="bi bi-grid-1x2"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
            <li><a href="tracking.html"><i class="bi bi-geo-alt"></i> Ø§Ù„ØªØªØ¨Ø¹</a></li>
            <li><a href="whatsapp.html"><i class="bi bi-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨</a></li>
        </ul>
    </nav>

    <!-- ====== Page Title ====== -->
    <div class="wa-page-title">
        <h2><i class="bi bi-whatsapp" style="color: #25d366;"></i> Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§ØªØ³Ø§Ø¨</h2>
        <p>ØªØ¬Ø±Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ø¨Ø± Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</p>
    </div>

    <!-- ====== Progress ====== -->
    <div class="wa-progress-wrap">
        <span class="wa-progress-text" id="progressText">0 / 10</span>
        <div class="wa-progress-bar">
            <div class="wa-progress-fill" id="progressFill"></div>
        </div>
    </div>

    <!-- ====== Phone Frame ====== -->
    <div class="phone-frame">

        <!-- WhatsApp Header -->
        <div class="wa-header">
            <span class="wa-header-back"><i class="bi bi-arrow-left"></i></span>
            <div class="wa-header-avatar">AZ</div>
            <div class="wa-header-info">
                <div class="wa-header-name">Alzamil Delivery Ø§Ù„Ø²Ø§Ù…Ù„ Ù„Ù„ØªÙˆØµÙŠÙ„</div>
                <div class="wa-header-status" id="waStatus">Ù…ØªØµÙ„</div>
            </div>
            <div class="wa-header-actions">
                <i class="bi bi-camera-video"></i>
                <i class="bi bi-telephone"></i>
                <i class="bi bi-three-dots-vertical"></i>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="wa-chat" id="waChat">
            <!-- Date chip -->
            <div class="wa-date-chip">
                <span>Ø§Ù„ÙŠÙˆÙ…</span>
            </div>
        </div>

        <!-- Input Bar (decorative) -->
        <div class="wa-input-bar">
            <span class="wa-input-emoji"><i class="bi bi-emoji-smile"></i></span>
            <div class="wa-input-field">Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©</div>
            <span class="wa-input-attach"><i class="bi bi-paperclip"></i></span>
            <span class="wa-input-mic"><i class="bi bi-mic-fill"></i></span>
        </div>

    </div>

    <!-- ====== Controls ====== -->
    <div class="wa-controls">
        <button class="wa-ctrl-btn replay" id="btnReplay" onclick="replayChat()">
            <i class="bi bi-arrow-counterclockwise"></i>
            Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„
        </button>

        <button class="wa-ctrl-btn pause-resume" id="btnPause" onclick="togglePause()">
            <i class="bi bi-pause-fill" id="pauseIcon"></i>
            <span id="pauseLabel">Ø¥ÙŠÙ‚Ø§Ù</span>
        </button>

        <div class="wa-speed-group">
            <button class="wa-speed-btn active" data-speed="1" onclick="setSpeed(1, this)">1x</button>
            <button class="wa-speed-btn" data-speed="2" onclick="setSpeed(2, this)">2x</button>
            <button class="wa-speed-btn" data-speed="3" onclick="setSpeed(3, this)">3x</button>
        </div>
    </div>

    <!-- ====== Footer ====== -->
    <div style="text-align: center; padding: 1rem 1rem 2rem; color: var(--text-secondary); font-size: 0.85rem;">
        <p>MBSC MiM - Integrated Management Challenge | Hackathon Prototype</p>
    </div>

    <!-- ====== Scripts ====== -->
    <script src="js/shared.js"></script>
    <script>
    (function () {
        'use strict';

        /* ================================================
           MESSAGE DATA
           ================================================ */
        var messages = [
            {
                id: 1,
                type: 'sent',
                text: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡! \u{1F44B} ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ #AZ-2026-0847 (Ø®Ø²Ø§Ù† Ø¹Ù…ÙˆØ¯ÙŠ 10,000 Ù„ØªØ±). Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ ØªÙ‚ÙŠÙŠÙ… Ø³Ø±ÙŠØ¹ Ù„Ù„Ù…ÙˆÙ‚Ø¹ (5 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø·):',
                time: '2:30 Ù…',
                hasLinkPreview: true,
                linkPreview: {
                    icon: '\u{1F4CB}',
                    title: 'ØªÙ‚ÙŠÙŠÙ… Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ - ASDP',
                    desc: 'Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ 7 Ø£Ø³Ø¦Ù„Ø© Ø³Ø±ÙŠØ¹Ø© Ù„ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„ ÙˆØªØ­Ø¯ÙŠØ¯ Ø£ÙØ¶Ù„ Ø·Ø±ÙŠÙ‚Ø© Ù„Ù„ØªÙˆØµÙŠÙ„',
                    url: 'asdp.alzamil.com/sra'
                }
            },
            {
                id: 2,
                type: 'received',
                text: 'ØªÙ…ØŒ Ø£ÙƒÙ…Ù„Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ… \u2705',
                time: '2:37 Ù…'
            },
            {
                id: 3,
                type: 'sent',
                text: 'Ø´ÙƒØ±Ø§Ù‹! Ø¬Ø§Ø±ÙŠ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹... Ø³ØªØ³Ù…Ø¹ Ù…Ù†Ø§ Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹ØªÙŠÙ†.',
                time: '2:38 Ù…'
            },
            {
                id: 4,
                type: 'sent',
                text: 'Ø£Ø®Ø¨Ø§Ø± Ø±Ø§Ø¦Ø¹Ø©! \u{1F389} ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆÙ‚Ø¹Ùƒ: Ø£Ø®Ø¶Ø± \u2705 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙˆØµÙŠÙ„). Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù„ÙŠÙ„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø³Ø§Ø¹Ø© 9-11 Ù…Ø³Ø§Ø¡Ù‹. Ø¨Ø¯ÙˆÙ† ØªØµØ§Ø±ÙŠØ­ Ù…Ø·Ù„ÙˆØ¨Ø©!',
                time: '4:15 Ù…'
            },
            {
                id: 5,
                type: 'received',
                text: 'Ù…Ù…ØªØ§Ø²! Ø´ÙƒØ±Ø§Ù‹ \u{1F44D}',
                time: '4:18 Ù…'
            },
            {
                id: 6,
                type: 'sent',
                text: '\u23F0 ØªØ°ÙƒÙŠØ±: ØªÙˆØµÙŠÙ„Ùƒ Ø§Ù„Ù„ÙŠÙ„Ø© Ø¨ÙŠÙ† 9-11 Ù…Ø³Ø§Ø¡Ù‹.\n\nÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù†:\n\u2705 ÙØªØ­ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©\n\u2705 Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø³ÙŠØ§Ø±Ø§Øª Ù…Ù† Ø£Ù…Ø§Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰\n\u2705 Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù…Ø¯Ø®Ù„',
                time: '8:00 Ù…'
            },
            {
                id: 7,
                type: 'sent',
                text: '\u{1F69B} Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø£Ø­Ù…Ø¯ ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚!\n\nØ§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: 23 Ø¯Ù‚ÙŠÙ‚Ø©\nØ±Ù‚Ù… Ø§Ù„Ø´Ø§Ø­Ù†Ø©: Ø£ Ø¨ Ø¬ 1234\n\n\u{1F4CD} ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø±: [Ø±Ø§Ø¨Ø· Ø§Ù„ØªØªØ¨Ø¹]',
                time: '9:12 Ù…'
            },
            {
                id: 8,
                type: 'sent',
                text: '\u2705 ØªÙ… ØªÙˆØµÙŠÙ„ Ø§Ù„Ø®Ø²Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!\n\n\u23F0 Ø§Ù„Ø³Ø§Ø¹Ø©: 10:15 Ù…Ø³Ø§Ø¡Ù‹\n\u{1F4CD} Ø§Ù„Ù…ÙˆÙ‚Ø¹: Ø­ÙŠ Ø§Ù„Ù†Ø±Ø¬Ø³ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶\n\u{1F69B} Ø§Ù„Ø³Ø§Ø¦Ù‚: Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø­Ù…Ø¯ÙŠ\n\nØ§Ù„Ø®Ø²Ø§Ù† Ù…ÙˆØ¶ÙˆØ¹ ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡. Ø§Ù„Ø´Ø§Ø­Ù†Ø© Ø³ØªØ¹ÙˆØ¯ ØºØ¯Ø§Ù‹ 8-10 ØµØ¨Ø§Ø­Ø§Ù‹ Ù„Ø±ÙØ¹ Ø§Ù„Ø®Ø²Ø§Ù† ÙˆØªØ±ÙƒÙŠØ¨Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·Ø­.',
                time: '10:17 Ù…',
                hasPhoto: true
            },
            {
                id: 9,
                type: 'received',
                text: 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…ØŒ Ø´ÙƒØ±Ø§Ù‹! Ø§Ù„Ø®Ø²Ø§Ù† Ù…ÙˆØ¬ÙˆØ¯ \u{1F44D}',
                time: '10:20 Ù…'
            },
            {
                id: 10,
                type: 'sent',
                text: 'Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡! \u{1F60A}\n\nÙƒÙŠÙ ØªÙ‚ÙŠÙ… ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ØŸ\n\u2B50\u2B50\u2B50\u2B50\u2B50\n\nØ±Ø£ÙŠÙƒ ÙŠÙ‡Ù…Ù†Ø§ Ù„ØªØ­Ø³ÙŠÙ† Ø®Ø¯Ù…Ø§ØªÙ†Ø§.',
                time: '10:21 Ù…'
            }
        ];

        /* ================================================
           STATE
           ================================================ */
        var currentIndex = 0;
        var speed = 1;
        var isPaused = false;
        var timers = [];
        var isPlaying = false;
        var totalMessages = messages.length;

        /* ================================================
           DOM REFERENCES
           ================================================ */
        var chatEl = document.getElementById('waChat');
        var progressFill = document.getElementById('progressFill');
        var progressText = document.getElementById('progressText');
        var waStatus = document.getElementById('waStatus');
        var btnPause = document.getElementById('btnPause');
        var pauseIcon = document.getElementById('pauseIcon');
        var pauseLabel = document.getElementById('pauseLabel');

        /* ================================================
           HELPERS
           ================================================ */
        function delay(ms) {
            return ms / speed;
        }

        function scrollToBottom() {
            chatEl.scrollTop = chatEl.scrollHeight;
        }

        function updateProgress() {
            var pct = (currentIndex / totalMessages) * 100;
            progressFill.style.width = pct + '%';
            progressText.textContent = currentIndex + ' / ' + totalMessages;
        }

        function clearAllTimers() {
            for (var i = 0; i < timers.length; i++) {
                clearTimeout(timers[i]);
            }
            timers = [];
        }

        /* ================================================
           BUILD MESSAGE HTML
           ================================================ */
        function buildBubbleHTML(msg) {
            var html = '';

            // Photo attachment (before text for message 8)
            if (msg.hasPhoto) {
                html += '<div class="wa-photo">';
                html += '<div class="wa-photo-icon"><i class="bi bi-image"></i></div>';
                html += '<div class="wa-photo-label">ØµÙˆØ±Ø© Ø§Ù„Ø®Ø²Ø§Ù† Ø¨Ø¹Ø¯ Ø§Ù„ØªÙˆØµÙŠÙ„</div>';
                html += '</div>';
            }

            // Link preview (for message 1)
            if (msg.hasLinkPreview && msg.linkPreview) {
                var lp = msg.linkPreview;
                html += '<div class="wa-link-preview">';
                html += '<div class="wa-link-preview-img">' + lp.icon + '</div>';
                html += '<div class="wa-link-preview-body">';
                html += '<div class="wa-link-preview-title">' + lp.title + '</div>';
                html += '<div class="wa-link-preview-desc">' + lp.desc + '</div>';
                html += '<div class="wa-link-preview-url">' + lp.url + '</div>';
                html += '</div>';
                html += '</div>';
            }

            // Text
            var escapedText = msg.text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\n/g, '<br>');

            // Make link text look like WhatsApp links
            escapedText = escapedText.replace(
                /\[Ø±Ø§Ø¨Ø· Ø§Ù„ØªØªØ¨Ø¹\]/g,
                '<span style="color:#027eb5;text-decoration:underline;cursor:pointer;">asdp.alzamil.com/track/AZ-2026-0847</span>'
            );
            escapedText = escapedText.replace(
                /ğŸ”— ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹/g,
                '<span style="color:#027eb5;text-decoration:underline;cursor:pointer;">\u{1F517} ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹</span>'
            );

            html += '<div class="wa-text">';
            html += escapedText;

            // Spacer so text doesn't overlap timestamp
            if (msg.type === 'sent') {
                html += '<span class="wa-text-spacer"></span>';
            } else {
                html += '<span class="wa-text-spacer"></span>';
            }
            html += '</div>';

            // Timestamp + ticks
            html += '<div class="wa-meta">';
            if (msg.type === 'sent') {
                html += '<span class="wa-ticks">\u2713\u2713</span>';
            }
            html += '<span class="wa-time">' + msg.time + '</span>';
            html += '</div>';

            return html;
        }

        /* ================================================
           TYPING INDICATOR
           ================================================ */
        function showTyping() {
            // Update header status
            waStatus.textContent = 'ÙŠÙƒØªØ¨...';

            var row = document.createElement('div');
            row.className = 'wa-typing-row';
            row.id = 'typingIndicator';

            var bubble = document.createElement('div');
            bubble.className = 'wa-typing-bubble';
            bubble.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';

            row.appendChild(bubble);
            chatEl.appendChild(row);
            scrollToBottom();
        }

        function hideTyping() {
            waStatus.textContent = 'Ù…ØªØµÙ„';
            var el = document.getElementById('typingIndicator');
            if (el) el.remove();
        }

        /* ================================================
           ADD MESSAGE
           ================================================ */
        function addMessage(msg) {
            var row = document.createElement('div');
            row.className = 'wa-msg-row ' + msg.type;

            var bubble = document.createElement('div');
            bubble.className = 'wa-bubble';
            bubble.innerHTML = buildBubbleHTML(msg);

            row.appendChild(bubble);
            chatEl.appendChild(row);

            currentIndex++;
            updateProgress();
            scrollToBottom();
        }

        /* ================================================
           PLAY SEQUENCE
           ================================================ */
        function playSequence() {
            if (isPlaying) return;
            isPlaying = true;
            isPaused = false;
            currentIndex = 0;
            updatePauseButton();

            // Calculate cumulative times
            // Each message: typing delay + typing duration + small gap
            var cumulativeDelay = delay(1500); // Initial delay

            for (var i = 0; i < messages.length; i++) {
                (function (index, startDelay) {
                    var msg = messages[index];

                    // Only show typing for sent (ASDP) messages
                    var typingDuration;
                    if (msg.type === 'sent') {
                        // Longer messages get slightly longer typing
                        typingDuration = delay(1200 + Math.min(msg.text.length * 3, 800));

                        // Show typing
                        var t1 = setTimeout(function () {
                            if (isPaused) return;
                            showTyping();
                        }, startDelay);
                        timers.push(t1);

                        // Hide typing + show message
                        var t2 = setTimeout(function () {
                            if (isPaused) return;
                            hideTyping();
                            addMessage(msg);
                            // Check if last message
                            if (index === messages.length - 1) {
                                isPlaying = false;
                            }
                        }, startDelay + typingDuration);
                        timers.push(t2);

                    } else {
                        // Customer messages: slight delay, no typing indicator shown from ASDP side
                        typingDuration = delay(800);

                        var t3 = setTimeout(function () {
                            if (isPaused) return;
                            addMessage(msg);
                            if (index === messages.length - 1) {
                                isPlaying = false;
                            }
                        }, startDelay + typingDuration);
                        timers.push(t3);
                    }

                })(i, cumulativeDelay);

                // Calculate next message start time
                var msg = messages[i];
                if (msg.type === 'sent') {
                    var typDur = delay(1200 + Math.min(msg.text.length * 3, 800));
                    cumulativeDelay += typDur + delay(600);
                } else {
                    cumulativeDelay += delay(800) + delay(600);
                }
            }
        }

        /* ================================================
           CONTROLS
           ================================================ */

        // Replay
        window.replayChat = function () {
            clearAllTimers();
            hideTyping();
            isPlaying = false;
            isPaused = false;
            currentIndex = 0;
            updateProgress();
            updatePauseButton();

            // Clear chat except date chip
            chatEl.innerHTML = '<div class="wa-date-chip"><span>Ø§Ù„ÙŠÙˆÙ…</span></div>';

            // Restart
            setTimeout(function () {
                playSequence();
            }, 300);
        };

        // Pause / Resume
        window.togglePause = function () {
            if (!isPlaying && !isPaused) return;

            if (isPaused) {
                // Resume: replay remaining messages
                isPaused = false;
                updatePauseButton();
                resumeFromCurrent();
            } else {
                // Pause
                isPaused = true;
                clearAllTimers();
                hideTyping();
                updatePauseButton();
            }
        };

        function resumeFromCurrent() {
            // Re-play from currentIndex
            isPlaying = true;
            var resumeDelay = delay(500);

            for (var i = currentIndex; i < messages.length; i++) {
                (function (index, startDelay) {
                    var msg = messages[index];
                    var typingDuration;

                    if (msg.type === 'sent') {
                        typingDuration = delay(1200 + Math.min(msg.text.length * 3, 800));

                        var t1 = setTimeout(function () {
                            if (isPaused) return;
                            showTyping();
                        }, startDelay);
                        timers.push(t1);

                        var t2 = setTimeout(function () {
                            if (isPaused) return;
                            hideTyping();
                            addMessage(msg);
                            if (index === messages.length - 1) isPlaying = false;
                        }, startDelay + typingDuration);
                        timers.push(t2);

                    } else {
                        typingDuration = delay(800);
                        var t3 = setTimeout(function () {
                            if (isPaused) return;
                            addMessage(msg);
                            if (index === messages.length - 1) isPlaying = false;
                        }, startDelay + typingDuration);
                        timers.push(t3);
                    }

                })(i, resumeDelay);

                var msg = messages[i];
                if (msg.type === 'sent') {
                    var typDur = delay(1200 + Math.min(msg.text.length * 3, 800));
                    resumeDelay += typDur + delay(600);
                } else {
                    resumeDelay += delay(800) + delay(600);
                }
            }
        }

        function updatePauseButton() {
            if (isPaused) {
                btnPause.classList.add('paused');
                pauseIcon.className = 'bi bi-play-fill';
                pauseLabel.textContent = 'Ø§Ø³ØªØ¦Ù†Ø§Ù';
            } else {
                btnPause.classList.remove('paused');
                pauseIcon.className = 'bi bi-pause-fill';
                pauseLabel.textContent = 'Ø¥ÙŠÙ‚Ø§Ù';
            }
        }

        // Speed
        window.setSpeed = function (s, btn) {
            speed = s;

            // Update active button
            var speedBtns = document.querySelectorAll('.wa-speed-btn');
            for (var i = 0; i < speedBtns.length; i++) {
                speedBtns[i].classList.remove('active');
            }
            btn.classList.add('active');

            // If currently playing, restart from current position
            if (isPlaying && !isPaused) {
                clearAllTimers();
                hideTyping();
                isPlaying = false;
                resumeFromCurrent();
            }
        };

        /* ================================================
           INIT
           ================================================ */
        updateProgress();
        playSequence();

    })();
    </script>
</body>
</html>
